(this["webpackJsonp@kyberswap/interface"]=this["webpackJsonp@kyberswap/interface"]||[]).push([[40],{"./src/components/swapv2/Routing.tsx":function(e,t,o){"use strict";o.r(t);var n=o("./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),i=o("./node_modules/@kyberswap/ks-sdk-core/dist/index.js"),r=o("./node_modules/react/index.js"),a=o.n(r),s=o("./node_modules/react-indiana-drag-scroll/dist/index.es.js"),d=o("./node_modules/styled-components/dist/styled-components.browser.esm.js"),l=o("./src/components/CurrencyLogo/index.tsx"),c=o("./src/hooks/index.ts"),p=o("./src/hooks/Tokens.ts"),u=o("./src/hooks/useThrottle.ts"),b=o("./src/state/customizeDexes/hooks.ts"),h=o("./src/state/swap/actions.ts"),m=o("./src/state/swap/hooks.ts"),g=o("./src/utils/index.ts"),x=o("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),v=o("./node_modules/@kyberswap/ks-sdk-classic/dist/index.js"),f=o("./node_modules/jsbi/dist/jsbi-umd.js"),w=o.n(f);function j(e,t,o){var n;if(e&&e.swaps&&t){var r=null===(n=e.inputAmount)||void 0===n?void 0:n.wrapped,a=function(t,o){var n;if(t&&o&&((null===t||void 0===t?void 0:t.toLowerCase())===(null===r||void 0===r||null===(n=r.currency.address)||void 0===n?void 0:n.toLowerCase())&&e.inputAmount.greaterThan(w.a.BigInt(0)))){var a=new i.Percent(w.a.BigInt(o||0),e.inputAmount.quotient).toFixed(0);return parseInt(a)}},s=e.tokens||{},d=new i.Token(t,i.WETH[t].address,0,"--","--"),l=[];return e.swaps.forEach((e=>{if(1===e.length){var n,r=e[0],c=[(null===o||void 0===o?void 0:o[Object(g.s)(t,r.tokenIn)])||s[r.tokenIn]||d,(null===o||void 0===o?void 0:o[Object(g.s)(t,r.tokenOut)])||s[r.tokenOut]||d];l.push({slug:null===(n=r.tokenOut)||void 0===n?void 0:n.toLowerCase(),pools:[{id:r.pool,exchange:r.exchange,swapAmount:w.a.BigInt(r.swapAmount),swapPercentage:a(r.tokenIn,r.swapAmount)}],path:c,id:r.pool})}else if(e.length>1){var p=[],u=[];e.forEach(((e,n)=>{if(u.push({id:e.pool,exchange:e.exchange,swapAmount:w.a.BigInt(e.swapAmount),swapPercentage:0===n?a(e.tokenIn,e.swapAmount):100}),0===n){var r=s[e.tokenIn]||d;p.push((null===o||void 0===o?void 0:o[Object(g.s)(t,r.address)])||new i.Token(t,r.address,r.decimals,r.symbol,r.name))}var l=s[e.tokenOut]||d;p.push((null===o||void 0===o?void 0:o[Object(g.s)(t,l.address)])||new i.Token(t,l.address,l.decimals,l.symbol,l.name))})),l.push({slug:p.slice(1).map((e=>e.address)).join("-").toLowerCase(),path:p,pools:u,id:u.map((e=>e.id)).join("-")})}})),function(e){if(!e.length)return[];try{var t=-1,o=e.reduce(((e,o)=>{var n,r,a=[],s=o.pools&&(null===(n=o.pools[0])||void 0===n?void 0:n.swapPercentage)||0;if(e[o.slug]){var d=e[o.slug]||{};r=d.index;var l=d.subRoutes||[];s+=d.swapPercentage||0,l.forEach(((e,t)=>{var n=o.pools&&o.pools[t]||{},r=w.a.add(e.reduce(((e,t)=>w.a.add(e,t.swapAmount||v.ZERO)),v.ZERO),n.swapAmount||v.ZERO),s=!1,d=e.map((e=>{var t=Object(x.a)({},e),o=t.id===n.id,a=t.swapAmount||v.ZERO;o&&(s=!0,a=w.a.add(a,n.swapAmount||v.ZERO));var d=new i.Percent(a,r).toFixed(0,void 0,i.Rounding.ROUND_HALF_UP);return t.swapPercentage=parseInt(d),t.total=r.toString(),t}));if(!s){var l=new i.Percent(n.swapAmount||v.ZERO,r).toFixed(0,void 0,i.Rounding.ROUND_HALF_UP);d.push(Object(x.a)(Object(x.a)({},n),{},{swapPercentage:parseInt(l)}))}a[t]=d}))}else r=t+=1,a=o.pools.map((e=>[Object(x.a)(Object(x.a)({},e),{},{swapPercentage:100})]));return Object.assign({},e,{[o.slug]:{index:r,swapPercentage:s,path:o.path,subRoutes:a}})}),{}),n=Object.keys(o).length,r=new Array(n).map((()=>({})));return Object.values(o).forEach((e=>{e.index>n||r.splice(e.index,1,{swapPercentage:e.swapPercentage,path:e.path,subRoutes:e.subRoutes,id:e.subRoutes.flat().map((e=>e.id)).join("-")})})),r}catch(a){return console.error("[error_routesV2]",a),[]}}(l)}}var y,O=o("./src/utils/dmm.ts"),k=o("./node_modules/react/jsx-runtime.js"),R=d.default.div.withConfig({displayName:"Routing__Shadow",componentId:"sc-12w727b-0"})(["position:relative;min-height:0;overflow:hidden;&:before,&:after{content:'';display:block;z-index:3;pointer-events:none;position:absolute;height:50px;width:100%;left:50%;transform:translateX(-50%);transition:all 0.2s ease;opacity:0;}&:before{background:linear-gradient(to bottom,",",transparent);top:0;}&:after{background:linear-gradient(to top,",",transparent);bottom:0;}&.top:before,&.bottom:after{opacity:1;}"],(e=>e.backgroundColor),(e=>e.backgroundColor)),_=d.default.div.withConfig({displayName:"Routing__StyledContainer",componentId:"sc-12w727b-1"})(["flex:1;max-height:100%;max-width:100%;margin-left:0;overflow-y:scroll;overflow-x:hidden;&::-webkit-scrollbar{width:6px;height:6px;}&::-webkit-scrollbar-thumb{background:transparent;border-radius:999px;}&:hover::-webkit-scrollbar-thumb{background:",";border-radius:999px;}&::-webkit-scrollbar-track-piece{background:transparent;}"],(e=>e.theme.border)),C=d.default.div.withConfig({displayName:"Routing__StyledPair",componentId:"sc-12w727b-2"})(["position:relative;padding-top:12px;display:flex;justify-content:space-between;align-items:center;"]),I=d.default.div.withConfig({displayName:"Routing__StyledPairLine",componentId:"sc-12w727b-3"})(["flex:auto;min-width:50px;border-bottom:1px solid ",";height:1px;"],(e=>e.theme.border)),L=d.default.div.withConfig({displayName:"Routing__StyledWrapToken",componentId:"sc-12w727b-4"})(["display:flex;align-items:center;justify-content:space-between;min-width:100px;width:max-content;font-size:16px;font-weight:500;white-space:nowrap;min-height:38px;border-radius:0.5rem;",""],(e=>e.theme.mediaWidth.upToSmall(y||(y=Object(n.a)(["\n    min-width: 120px;\n  "]))))),P=d.default.a.withConfig({displayName:"Routing__StyledToken",componentId:"sc-12w727b-5"})(["width:100%;display:flex;align-items:center;white-space:nowrap;text-decoration:none;color:",";"," padding-bottom:7px;border-bottom:1px solid ",";& > span{margin-left:4px;margin-right:4px;}"],(e=>e.theme.subText),(e=>e.reverse&&Object(d.css)(["flex-direction:row-reverse;justify-content:flex-start;"])),(e=>e.theme.border)),N=d.default.div.withConfig({displayName:"Routing__StyledRoutes",componentId:"sc-12w727b-6"})(["margin:auto;width:100%;position:relative;padding:20px 10px 0;&:before{position:absolute;display:block;content:'';top:0;right:0;}"]),S=d.default.div.withConfig({displayName:"Routing__StyledRoute",componentId:"sc-12w727b-7"})(["display:flex;justify-content:flex-end;position:relative;align-items:center;&:before,&:after{content:'';display:block;border-left:1px solid ",";width:100%;height:calc(50% + 20px);position:absolute;border-right:1px solid ",";box-sizing:border-box;pointer-events:none;}&:before{top:-20px;}&:after{bottom:-10px;}&:last-child:after{display:none;}"],(e=>e.theme.border),(e=>e.theme.border)),T=d.default.div.withConfig({displayName:"Routing__StyledRouteLine",componentId:"sc-12w727b-8"})(["position:absolute;border-bottom:1px solid ",";width:calc(100% - 68px);left:43px;"],(e=>e.theme.border)),A=d.default.div.withConfig({displayName:"Routing__StyledHops",componentId:"sc-12w727b-9"})(["z-index:1;display:flex;align-items:center;"]),E=d.default.div.withConfig({displayName:"Routing__StyledHop",componentId:"sc-12w727b-10"})(["padding:8px;border-radius:8px;background-color:",";border:1px solid ",";height:fit-content;position:relative;flex:0 0 146px;margin:auto;transition:filter 0.15s ease;cursor:pointer;:hover{filter:",";}"],(e=>e.theme.background),(e=>e.theme.border),(e=>e.theme.darkMode?"brightness(130%)":"brightness(97%)")),z=d.default.a.withConfig({displayName:"Routing__StyledExchange",componentId:"sc-12w727b-11"})(["display:flex;align-items:center;width:100%;padding:4px 0;margin-top:4px;font-size:10px;border-radius:8px;color:",";line-height:20px;white-space:nowrap;text-decoration:none;&:hover{color:",";}& > .img--sm{width:14px;height:14px;border-radius:100%;margin-right:4px;}&:first-child{margin-top:8px;}"],(e=>e.theme.subText),(e=>{var t=e.theme;return t.darkMode?t.white:t.black})),U=d.default.div.withConfig({displayName:"Routing__StyledExchangeStatic",componentId:"sc-12w727b-12"})(["display:flex;align-items:center;width:100%;padding:4px 0;margin-top:4px;font-size:10px;border-radius:8px;color:",";line-height:20px;white-space:nowrap;text-decoration:none;& > .img--sm{width:14px;height:14px;border-radius:100%;margin-right:4px;}&:first-child{margin-top:8px;}"],(e=>e.theme.subText)),H=d.default.div.withConfig({displayName:"Routing__StyledPercent",componentId:"sc-12w727b-13"})(["font-size:12px;line-height:14px;font-weight:700;position:absolute;top:calc(50% - 15px);left:8px;transform:translateY(50%);z-index:2;color:",";background:",";"],(e=>e.theme.primary),(e=>e.backgroundColor)),F=d.default.i.withConfig({displayName:"Routing__StyledDot",componentId:"sc-12w727b-14"})(["display:inline-block;width:8px;height:8px;border-radius:100%;position:absolute;top:0;left:",";right:",";z-index:1;background-color:",";"],(e=>e.out?"unset":"6.5px"),(e=>e.out?"6.5px":"unset"),(e=>e.theme.primary)),M=d.default.div.withConfig({displayName:"Routing__StyledWrap",componentId:"sc-12w727b-15"})(["width:calc(100% - 68px);margin:10px 0 10px 6px;&:after,&:before{transition:all 0.1s ease;content:'';display:block;z-index:2;pointer-events:none;position:absolute;inset:0 0 auto auto;width:40px;height:calc(100% - 20px);top:50%;transform:translateY(-50%);opacity:0;}&:after{background:linear-gradient(to right,",",transparent);left:42px;}&:before{background:linear-gradient(to left,",",transparent);right:24px;}&.left-visible:after,&.right-visible:before{opacity:1;}"],(e=>e.backgroundColor),(e=>e.backgroundColor)),W=d.default.div.withConfig({displayName:"Routing__StyledHopChevronRight",componentId:"sc-12w727b-16"})(["border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:5px solid ",";"],(e=>e.theme.primary)),Z=d.default.div.withConfig({displayName:"Routing__StyledHopChevronWrapper",componentId:"sc-12w727b-17"})(["min-width:24px;height:24px;display:flex;align-items:center;justify-content:center;z-index:1;"]),B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(1===t)return"100%";if(!e&&0!==e)return null;var o=t>1?Math.min(99.99,Math.max(.01,e)):e;return"".concat(o.toFixed(0),"%")},D=e=>{var t,o=e.route,n=e.chainId,i=e.backgroundColor,d=Object(r.useRef)(null),c=Object(r.useRef)(null),p=Object(r.useRef)(null),h=Object(b.a)(),m=Object(u.a)((()=>{var e,t,o,n,i,r=d.current;(null===r||void 0===r?void 0:r.scrollLeft)>0?null===(t=p.current)||void 0===t||t.classList.add("left-visible"):null===(o=p.current)||void 0===o||o.classList.remove("left-visible");Math.floor((null===(e=c.current)||void 0===e?void 0:e.scrollWidth)-(null===r||void 0===r?void 0:r.scrollLeft))>Math.floor(null===r||void 0===r?void 0:r.clientWidth)?null===(n=p.current)||void 0===n||n.classList.add("right-visible"):null===(i=p.current)||void 0===i||i.classList.remove("right-visible")}),300);return Object(r.useEffect)((()=>(window.addEventListener("resize",m),()=>window.removeEventListener("resize",m))),[]),Object(r.useEffect)((()=>{m()}),[o]),Object(k.jsx)(M,{ref:p,backgroundColor:i,children:Object(k.jsx)(s.a,{innerRef:d,vertical:!1,onScroll:m,children:Object(k.jsx)(A,{length:null===o||void 0===o||null===(t=o.subRoutes)||void 0===t?void 0:t.length,ref:c,children:o.subRoutes.map(((e,t,i)=>{var r=o.path[t+1],s=e.flat().map((e=>e.id)).join("-");return Object(k.jsxs)(a.a.Fragment,{children:[Object(k.jsxs)(E,{children:[Object(k.jsxs)(P,{style:{marginRight:0},href:Object(g.n)(n,null===r||void 0===r?void 0:r.address,"token"),target:"_blank",children:[Object(k.jsx)(l.a,{currency:r,size:"16px"}),Object(k.jsx)("span",{children:null===r||void 0===r?void 0:r.symbol})]}),Array.isArray(e)?e.map((e=>{var t,o=((e,t)=>"1inch"===e.exchange?{name:"1inch",logoURL:"https://s2.coinmarketcap.com/static/img/coins/64x64/8104.png"}:"paraswap"===e.exchange?{name:"Paraswap",logoURL:"https://s2.coinmarketcap.com/static/img/coins/64x64/14534.png"}:"0x"===e.exchange?{name:"0x",logoURL:"https://s2.coinmarketcap.com/static/img/coins/64x64/1896.png"}:null===t||void 0===t?void 0:t.find((t=>t.id===e.exchange||("kyberswap"===e.exchange||"kyberswap-static"===e.exchange)&&"kyberswapv1"===t.id)))(e,h);return t=Object(k.jsxs)(k.Fragment,{children:[null!==o&&void 0!==o&&o.logoURL?Object(k.jsx)("img",{src:null===o||void 0===o?void 0:o.logoURL,alt:"",className:"img--sm"}):Object(k.jsx)("i",{className:"img--sm"}),"".concat((null===o||void 0===o?void 0:o.name)||"--",": ").concat(e.swapPercentage,"%")]}),Object(g.r)(n,e.id)?Object(k.jsx)(z,{href:Object(g.n)(n,e.id,"address"),target:"_blank",children:t},"".concat(t,"-").concat(e.id)):Object(k.jsx)(U,{children:t},"".concat(t,"-").concat(e.id))})):null]}),t!==i.length-1&&Object(k.jsx)(Z,{children:Object(k.jsx)(W,{})})]},s)}))})})})},J=e=>{var t=e.trade,o=e.currencies,n=e.formattedAmounts,a=e.maxHeight,s=Object(c.b)().chainId,d=Object(r.useRef)(null),u=Object(r.useRef)(null),b=Object(r.useRef)(null),g=Object(O.j)(o[h.a.INPUT]||void 0),x=Object(O.j)(o[h.a.OUTPUT]||void 0),v=Object(p.a)(),f=Object(r.useMemo)((()=>{try{return j(t,s,v)}catch(e){return}}),[t,s,v]),w=(e,t)=>{var o=t===h.a.OUTPUT,r=e instanceof i.CurrencyAmount?null===e||void 0===e?void 0:e.currency:o?x:g;return s&&r?Object(k.jsxs)(P,{as:"div",reverse:o,style:{border:"none"},children:[Object(k.jsx)(l.a,{currency:r,size:"20px"}),Object(k.jsx)("span",{children:"".concat(r&&n[t]?n[t]:"0.0"," ").concat(r.symbol)})]}):null},y=t&&s&&f&&f.length>0,A=Object(r.useCallback)((()=>{var e,t,o,n,i,r,a,s,l,c=u.current;(null!==(e=null===c||void 0===c?void 0:c.scrollTop)&&void 0!==e?e:0)>0?null===d||void 0===d||null===(r=d.current)||void 0===r||r.classList.add("top"):null===d||void 0===d||null===(a=d.current)||void 0===a||a.classList.remove("top");(null!==(t=null===(o=b.current)||void 0===o?void 0:o.scrollHeight)&&void 0!==t?t:0)-(null!==(n=null===c||void 0===c?void 0:c.scrollTop)&&void 0!==n?n:0)>(null!==(i=null===c||void 0===c?void 0:c.clientHeight)&&void 0!==i?i:0)?null===(s=d.current)||void 0===s||s.classList.add("bottom"):null===(l=d.current)||void 0===l||l.classList.remove("bottom")}),[]);Object(r.useEffect)((()=>(window.addEventListener("resize",A),()=>window.removeEventListener("resize",A))),[A]),Object(r.useEffect)((()=>{A()}),[t,a]);var E=Object(m.f)(),z=E.feeConfig,U=E.typedValue;return Object(k.jsx)(R,{ref:d,children:Object(k.jsx)(_,{ref:u,onScroll:A,style:{maxHeight:a||"100%"},children:Object(k.jsxs)("div",{ref:b,children:[Object(k.jsxs)(C,{children:[Object(k.jsx)(L,{children:w(z?U:null===t||void 0===t?void 0:t.inputAmount,h.a.INPUT)}),!y&&Object(k.jsx)(I,{}),Object(k.jsx)(L,{children:w(null===t||void 0===t?void 0:t.outputAmount,h.a.OUTPUT)})]}),t&&s&&f&&f.length>0?Object(k.jsx)("div",{children:Object(k.jsxs)(N,{children:[Object(k.jsx)(F,{}),Object(k.jsx)(F,{out:!0}),f.map((e=>Object(k.jsxs)(S,{children:[Object(k.jsx)(H,{children:B(e.swapPercentage,f.length)}),Object(k.jsx)(T,{}),Object(k.jsx)(D,{route:e,chainId:s}),Object(k.jsx)(Z,{style:{marginRight:"2px"},children:Object(k.jsx)(W,{})})]},e.id)))]})}):null]})})})};t.default=Object(r.memo)(J)}}]);
//# sourceMappingURL=40.d1690ffc.chunk.js.map